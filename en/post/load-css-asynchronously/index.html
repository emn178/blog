<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="content-language" content="en"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Load CSS Asynchronously | emn178's Blog</title><meta name="keywords" content="Programming,CSS,FOUC,Flash of unstyled content,render-blocking,preload,SEO,PageSpeed,lighthouse,FCP,First Contentful Paint,LCP,Largest Contentful Paint"><meta name="author" content="emn178"><meta name="copyright" content="emn178"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="This article explains FOUC (Flash of unstyled content), render-blocking issues, and how to load CSS asynchronously. Flash of unstyled contentAfter the"><meta property="og:type" content="article"><meta property="og:title" content="Load CSS Asynchronously"><meta property="og:url" content="https://blog.emn178.cc/en/post/load-css-asynchronously/"><meta property="og:site_name" content="emn178&#39;s Blog"><meta property="og:description" content="This article explains FOUC (Flash of unstyled content), render-blocking issues, and how to load CSS asynchronously. Flash of unstyled contentAfter the"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://blog.emn178.cc/images/zh-TW/post/2023/load-css-asynchronously/CSS3_logo_and_wordmark.svg.png"><meta property="article:published_time" content="2023-07-28T14:20:34.000Z"><meta property="article:modified_time" content="2023-07-28T14:20:12.076Z"><meta property="article:author" content="emn178"><meta property="article:tag" content="AI,Coding,Programming,Technology"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://blog.emn178.cc/images/zh-TW/post/2023/load-css-asynchronously/CSS3_logo_and_wordmark.svg.png"><link rel="shortcut icon" href="/favicon.png"><link rel="canonical" href="https://blog.emn178.cc/en/post/load-css-asynchronously/"><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css?v=26"><link rel="preload" href="/libs/fontawesome-free-6.4.0/css/all.min.css" as="style" onload="this.onload=null;this.rel=&quot;stylesheet&quot;"><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:void 0,translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"Copy successfully",error:"Copy error",noSupport:"The browser does not support"},relativeDate:{homepage:!1,post:!1},runtime:"",date_suffix:{just:"Just",min:"minutes ago",hour:"hours ago",day:"days ago",month:"months ago"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1,percent:{toc:!0,rightside:!1}},delayScripts=[],delayStyles=[],maybeMobile=window.innerWidth<=800;if(delayScripts.push({delay:maybeMobile?1e3:0,src:"/js/lazyload.iife.min.js",onload:()=>initLazyLoad()}),delayScripts.push({delay:maybeMobile?2e3:1e3,src:"/js/fancybox.umd.min.js",onload:()=>runLightbox()}),delayStyles.push({delay:maybeMobile?2e3:1e3,href:"/css/fancybox.min.css"}),delayScripts.push({delay:3e3,src:"/libs/share-js/js/social-share.min.js"}),delayStyles.push({delay:3e3,href:"/libs/share-js/css/share.min.css"}),"localhost:4000"!==location.host){function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-MPNMQM2EN1"),gtag({event:"gtm.js","gtm.start":(new Date).getTime(),"gtm.uniqueEventId":0})}function initGTMOnEvent(e){document.removeEventListener(event.type,initGTMOnEvent),initGTM()}function initGTM(){if(window.gtmDidInit)return;window.gtmDidInit=!0;const e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=/G-MPNMQM2EN1",document.head.appendChild(e)}document.addEventListener("DOMContentLoaded",()=>{setTimeout(initGTM,3500)}),document.addEventListener("scroll",initGTMOnEvent),document.addEventListener("mousemove",initGTMOnEvent),document.addEventListener("touchstart",initGTMOnEvent),delayScripts.push({delay:0,src:"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"})</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Load CSS Asynchronously",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2023-07-28 22:20:12"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const n=864e5*o,a={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=o,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)}),e.getCSS=(e,t=!1)=>new Promise((o,n)=>{const a=document.createElement("link");a.rel="stylesheet",a.href=e,t&&(a.id=t),a.onerror=n,a.onload=a.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,o())},document.head.appendChild(a)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="alternate" href="/en/atom.xml" title="小殘的程式光廊" type="application/atom+xml">
<link rel="alternate" href="/en/rss2.xml" title="小殘的程式光廊" type="application/rss+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/images/loading.svg" data-src="/images/avatar.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"><noscript><img src="/images/avatar.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></noscript></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">213</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">23</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">15</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/en/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/en/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/en/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-rss"></i><span> Subscriptions</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/en/atom.xml"><i class="fa-fw fas fa-rss"></i><span> ATOM</span></a></li><li><a class="site-page child" href="/en/rss2.xml"><i class="fa-fw fas fa-rss"></i><span> RSS</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/zh-TW/"><i class="fa-fw fas fa-globe"></i><span> 中文</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(/images/zh-TW/post/2023/load-css-asynchronously/CSS3_logo_and_wordmark.svg.png)"><nav id="nav"><span id="blog-info"><a href="/en/" title="emn178's Blog"><span class="site-name">emn178's Blog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/en/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/en/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/en/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-rss"></i><span> Subscriptions</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/en/atom.xml"><i class="fa-fw fas fa-rss"></i><span> ATOM</span></a></li><li><a class="site-page child" href="/en/rss2.xml"><i class="fa-fw fas fa-rss"></i><span> RSS</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/zh-TW/"><i class="fa-fw fas fa-globe"></i><span> 中文</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Load CSS Asynchronously</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fas fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-07-28T14:20:34.000Z" title="Created 2023-07-28 22:20:34">2023-07-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-07-28T14:20:12.076Z" title="Updated 2023-07-28 22:20:12">2023-07-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/en/categories/Programming/">Programming</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="Load CSS Asynchronously"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>This article explains FOUC (Flash of unstyled content), render-blocking issues, and how to load CSS asynchronously.</p><h2 id="Flash-of-unstyled-content"><a href="#Flash-of-unstyled-content" class="headerlink" title="Flash of unstyled content"></a>Flash of unstyled content</h2><p>After the HTML is loaded, it will be displayed first, and then the CSS will be loaded. You will see the HTML screen without style first, and might load CSS style in short time. This causes it looks like a flicker. In addition to this situation, many webpages now also use JavaScript to render the screen, and similar problems will also occur.</p><p>例如一個使用 Bootstrap 的頁面放入一個按鈕<br>For example, puts a button in a page using Bootstrap.</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://www.google.com/&quot;</span>&gt;</span>Google<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>If FOUC occurs, there will be a moment to see<br><img src="/images/loading.svg" data-src="/images/zh-TW/post/2023/load-css-asynchronously/20230715155250.jpg" alt="FOUC" title="FOUC" width="110" height="105"><noscript><img src="/images/zh-TW/post/2023/load-css-asynchronously/20230715155250.jpg" alt="FOUC" title="FOUC" width="110" height="105"></noscript></p><p>The correct result will be seen after the style is loaded<br><img src="/images/loading.svg" data-src="/images/zh-TW/post/2023/load-css-asynchronously/20230715155228.jpg" alt="FOUC" title="FOUC" width="112" height="108"><noscript><img src="/images/zh-TW/post/2023/load-css-asynchronously/20230715155228.jpg" alt="FOUC" title="FOUC" width="112" height="108"></noscript></p><h2 id="Render-Blocking"><a href="#Render-Blocking" class="headerlink" title="Render-Blocking"></a>Render-Blocking</h2><p>In order to avoid the above situation, the browser uses render-blocking. It will start rendering the page after loading some rendering-blocking resources. CSS is one of the render-blocking resources, and the browser’s behavior is to start rendering after the style files are loaded. The above example would be the following result:</p><p>When the CSS is not loaded, you may see that the page is loading. The page will not display.<br><img src="/images/loading.svg" data-src="/images/zh-TW/post/2023/load-css-asynchronously/20230715160236.jpg" alt="Render-Blocking" title="Render-Blocking" width="139" height="37"><noscript><img src="/images/zh-TW/post/2023/load-css-asynchronously/20230715160236.jpg" alt="Render-Blocking" title="Render-Blocking" width="139" height="37"></noscript></p><p>When the CSS is loaded, you can see the styled page directly.<br><img src="/images/loading.svg" data-src="/images/zh-TW/post/2023/load-css-asynchronously/20230715155228.jpg" alt="Render-Blocking" title="Render-Blocking" width="112" height="108"><noscript><img src="/images/zh-TW/post/2023/load-css-asynchronously/20230715155228.jpg" alt="Render-Blocking" title="Render-Blocking" width="112" height="108"></noscript></p><h2 id="Load-CSS-Asynchronously"><a href="#Load-CSS-Asynchronously" class="headerlink" title="Load CSS Asynchronously"></a>Load CSS Asynchronously</h2><h3 id="Why"><a href="#Why" class="headerlink" title="Why"></a>Why</h3><p>Render-blocking may have solved the FOUC problem, but it seems to create new one. Assuming that the CSS is very large or the network is slow, the likely page takes a long time to display, or it may not even display at all. In addition, when using SEO analyzer such as PageSpeed, this will have a big impact on the scores of FCP (First Contentful Paint) and LCP (Largest Contentful Paint). So using an asynchronous way to load CSS has become a solution.</p><h3 id="How"><a href="#How" class="headerlink" title="How"></a>How</h3><p>Before asynchronously, let’s take a look at the general synchronous loading method:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>There are several common ways to achieve asynchronous</p><ul><li>Use rel&#x3D;”preload”</li><li>Use media&#x3D;”print”</li><li>Use JavaScript</li></ul><h4 id="Use-rel-x3D-”preload”"><a href="#Use-rel-x3D-”preload”" class="headerlink" title="Use rel&#x3D;”preload”"></a>Use rel&#x3D;”preload”</h4><p>Change to</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;preload&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css&quot;</span> <span class="attr">as</span>=<span class="string">&quot;style&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;this.onload=null;this.rel=&#x27;stylesheet&#x27;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">noscript</span>&gt;</span><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">noscript</span>&gt;</span></span><br></pre></td></tr></table></figure><p>The principle is to use the JavaScript onload event to replace it with a stylesheet. To avoid browsers that do not support JavaScript, and we add the noscript part. Note that if you want to set media in this way, you need to set it in onload, otherwise it will not load:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;preload&quot;</span> <span class="attr">href</span>=<span class="string">&quot;print.css&quot;</span> <span class="attr">as</span>=<span class="string">&quot;style&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;this.onload=null;this.rel=&#x27;stylesheet&#x27;;this.media=&#x27;print&#x27;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="Use-media-x3D-”print”"><a href="#Use-media-x3D-”print”" class="headerlink" title="Use media&#x3D;”print”"></a>Use media&#x3D;”print”</h4><p>Change to</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css&quot;</span> <span class="attr">media</span>=<span class="string">&quot;print&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;this.media=&#x27;all&#x27;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">noscript</span>&gt;</span><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">noscript</span>&gt;</span></span><br></pre></td></tr></table></figure><p>The principle is to use JavaScript onload event to change the condition to a displayable type. Media print is applied when printing, so it will not take effect when entering the webpage normally. Except print can be used directly, the others are written in onload.</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;print.css&quot;</span> <span class="attr">media</span>=<span class="string">&quot;print&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;desktop.css&quot;</span> <span class="attr">media</span>=<span class="string">&quot;print&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;this.media=&#x27;screen and (min-width:768px)&#x27;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="Use-JavaScript"><a href="#Use-JavaScript" class="headerlink" title="Use JavaScript"></a>Use JavaScript</h4><p>You can use the library <a target="_blank" rel="noopener" href="https://github.com/filamentgroup/loadCSS">loadCss</a> or write it by yourself, and add it after the page is loaded:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> link = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;link&#x27;</span>);</span><br><span class="line">link.<span class="property">rel</span> = <span class="string">&#x27;stylesheet&#x27;</span>;</span><br><span class="line">link.<span class="property">href</span> = <span class="string">&#x27;https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css&#x27;</span>;</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">head</span>.<span class="title function_">appendChild</span>(link);</span><br></pre></td></tr></table></figure><h4 id="Comparison"><a href="#Comparison" class="headerlink" title="Comparison"></a>Comparison</h4><p>The difference between the first two is not big, generally speaking, the browser compatibility of preload is relatively poor. It is recommended to use the second method. However, using JavaScript to load is quite different from the first two. The main difference is the timing of loading files.</p><p>Use media&#x3D;”print”</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css&quot;</span> <span class="attr">media</span>=<span class="string">&quot;print&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;this.media=&#x27;all&#x27;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>The loading sequence is as follows. It will start loading the file first after HTML parsed.<br><img src="/images/loading.svg" data-src="/images/zh-TW/post/2023/load-css-asynchronously/20230715173752.jpg" alt="loading sequence" title="loading sequence" width="664" height="358"><noscript><img src="/images/zh-TW/post/2023/load-css-asynchronously/20230715173752.jpg" alt="loading sequence" title="loading sequence" width="664" height="358"></noscript></p><p>Use JavaScript</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css&quot;</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> link = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;link&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">link.<span class="property">rel</span> = <span class="string">&#x27;stylesheet&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">link.<span class="property">href</span> = <span class="string">&#x27;https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">document</span>.<span class="property">head</span>.<span class="title function_">appendChild</span>(link);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>The loading sequence is as follows. It will start loading files after onload.<br><img src="/images/loading.svg" data-src="/images/zh-TW/post/2023/load-css-asynchronously/20230715173418.jpg" alt="loading sequence" title="loading sequence" width="689" height="345"><noscript><img src="/images/zh-TW/post/2023/load-css-asynchronously/20230715173418.jpg" alt="loading sequence" title="loading sequence" width="689" height="345"></noscript></p><h3 id="When"><a href="#When" class="headerlink" title="When"></a>When</h3><p>However, if you directly apply the above asynchronous loading method, you will find that… the FOUC problem happend. Because avoiding rendering blocking is equivalent to back to the beginning, and the FOUC problem will also backk. In fact, not all problems can be solved by changing to asynchronous without thinking. There is a prerequisite for using asynchronous loading CSS: <strong>only defer non-critical CSS</strong>. For example, the website uses some libraries like fancybox, which cannot be seen at first.</p><p>In most cases, the second method is sufficient. However, in practice, sometimes there are too many non-critical files. When downloading at the same time, the loading of the critical CSS is affected by the network bandwidth problem. For example, the following simulation:<br><img src="/images/loading.svg" data-src="/images/zh-TW/post/2023/load-css-asynchronously/20230715175302.jpg" alt="bandwidth" title="bandwidth" width="1885" height="425" class="extra-width"><noscript><img src="/images/zh-TW/post/2023/load-css-asynchronously/20230715175302.jpg" alt="bandwidth" title="bandwidth" width="1885" height="425" class="extra-width"></noscript></p><p>In this case, we can use JavaScript to avoid<br><img src="/images/loading.svg" data-src="/images/zh-TW/post/2023/load-css-asynchronously/20230715175537.jpg" alt="bandwidth" title="bandwidth" width="1643" height="281" class="extra-width"><noscript><img src="/images/zh-TW/post/2023/load-css-asynchronously/20230715175537.jpg" alt="bandwidth" title="bandwidth" width="1643" height="281" class="extra-width"></noscript></p><h3 id="Split-File"><a href="#Split-File" class="headerlink" title="Split File"></a>Split File</h3><p>After understanding the above principles, we know that non-critical CSS should use asynchronous loading, so we have to split the files. For example, originally saved as one file:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;all.css&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>May be split into multiple files</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;main.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;print.css&quot;</span> <span class="attr">media</span>=<span class="string">&quot;print&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;desktop.css&quot;</span> <span class="attr">media</span>=<span class="string">&quot;print&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;this.media=&#x27;screen and (min-width:768px)&#x27;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;mobile.css&quot;</span> <span class="attr">media</span>=<span class="string">&quot;print&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;this.media=&#x27;screen and (max-width:767px)&#x27;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://blog.emn178.cc">小殘</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://blog.emn178.cc/en/post/load-css-asynchronously/">https://blog.emn178.cc/en/post/load-css-asynchronously/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/images/zh-TW/post/2023/load-css-asynchronously/CSS3_logo_and_wordmark.svg.png" data-initialized="true"><a class="social-share-icon icon-facebook" href="#" aria-label="share to facebook"></a><a class="social-share-icon icon-twitter" href="#" aria-label="share to twitter"></a><a class="social-share-icon icon-wechat" href="#" aria-label="share to wechat"></a><a class="social-share-icon icon-weibo" href="#" aria-label="share to weibo"></a><a class="social-share-icon icon-qq" href="#" aria-label="share to qq"></a></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/en/post/gcp-cloud-monitoring-reduce-data-and-cost/" title="GCP Cloud Monitoring - Reduce Data and Cost"><img class="cover" src="/images/loading.svg" data-src="/images/zh-TW/post/2023/gcp-cloud-storage-can-not-download-or-copy/gcp.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><noscript><img class="cover" src="/images/zh-TW/post/2023/gcp-cloud-storage-can-not-download-or-copy/gcp.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"></noscript><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">GCP Cloud Monitoring - Reduce Data and Cost</div></div></a></div><div class="next-post pull-right"><a href="/en/post/zkevm-airdrop-guide/" title="zkEVM Airdrop Guide"><img class="cover" src="/images/loading.svg" data-src="/images/zh-TW/post/2023/zkevm-airdrop-guide/main.svg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><noscript><img class="cover" src="/images/zh-TW/post/2023/zkevm-airdrop-guide/main.svg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"></noscript><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">zkEVM Airdrop Guide</div></div></a></div></nav><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/images/loading.svg" data-src="/images/avatar.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"><noscript><img src="/images/avatar.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></noscript></div><div class="author-info__name">emn178</div><div class="author-info__description">A blog sharing experiences about programming and technology.</div></div><div class="card-info-data site-data is-center"><a href="/en/archives/"><div class="headline">Articles</div><div class="length-num">29</div></a><a href="/en/tags/"><div class="headline">Tags</div><div class="length-num">5</div></a><a href="/en/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Flash-of-unstyled-content"><span class="toc-number">1.</span> <span class="toc-text">Flash of unstyled content</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Render-Blocking"><span class="toc-number">2.</span> <span class="toc-text">Render-Blocking</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Load-CSS-Asynchronously"><span class="toc-number">3.</span> <span class="toc-text">Load CSS Asynchronously</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Why"><span class="toc-number">3.1.</span> <span class="toc-text">Why</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How"><span class="toc-number">3.2.</span> <span class="toc-text">How</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Use-rel-x3D-%E2%80%9Dpreload%E2%80%9D"><span class="toc-number">3.2.1.</span> <span class="toc-text">Use rel&#x3D;”preload”</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Use-media-x3D-%E2%80%9Dprint%E2%80%9D"><span class="toc-number">3.2.2.</span> <span class="toc-text">Use media&#x3D;”print”</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Use-JavaScript"><span class="toc-number">3.2.3.</span> <span class="toc-text">Use JavaScript</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Comparison"><span class="toc-number">3.2.4.</span> <span class="toc-text">Comparison</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#When"><span class="toc-number">3.3.</span> <span class="toc-text">When</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Split-File"><span class="toc-number">3.4.</span> <span class="toc-text">Split File</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/en/post/using-ethers-js-to-sign-eip-712-typed-structured-data/" title="Using Ethers.js to Sign and Recover EIP-712 Typed Structured Data"><img src="/images/loading.svg" data-src="/images/zh-TW/post/2023/ethers-js-parse-custom-error/ethers.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Using Ethers.js to Sign and Recover EIP-712 Typed Structured Data"><noscript><img src="/images/zh-TW/post/2023/ethers-js-parse-custom-error/ethers.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Using Ethers.js to Sign and Recover EIP-712 Typed Structured Data"></noscript></a><div class="content"><a class="title" href="/en/post/using-ethers-js-to-sign-eip-712-typed-structured-data/" title="Using Ethers.js to Sign and Recover EIP-712 Typed Structured Data">Using Ethers.js to Sign and Recover EIP-712 Typed Structured Data</a><time datetime="2023-10-14T02:17:23.000Z" title="Created 2023-10-14 10:17:23">2023-10-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/post/using-web3-js-to-sign-and-recover-eip-712-typed-structured-data/" title="Using Web3.js to Sign and Recover EIP-712 Typed Structured Data"><img src="/images/loading.svg" data-src="/images/zh-TW/post/2023/using-web3-js-to-parse-custom-error/web3js.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Using Web3.js to Sign and Recover EIP-712 Typed Structured Data"><noscript><img src="/images/zh-TW/post/2023/using-web3-js-to-parse-custom-error/web3js.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Using Web3.js to Sign and Recover EIP-712 Typed Structured Data"></noscript></a><div class="content"><a class="title" href="/en/post/using-web3-js-to-sign-and-recover-eip-712-typed-structured-data/" title="Using Web3.js to Sign and Recover EIP-712 Typed Structured Data">Using Web3.js to Sign and Recover EIP-712 Typed Structured Data</a><time datetime="2023-10-13T11:50:47.000Z" title="Created 2023-10-13 19:50:47">2023-10-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/post/solidity-eip-712-typed-structured-data-hashing-and-signing/" title="Solidity - EIP-712 Typed Structured Data Hashing and Signing"><img src="/images/loading.svg" data-src="/images/zh-TW/post/2018/solidity-gas-optimization-variable-ordering/solidity-logo.svg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Solidity - EIP-712 Typed Structured Data Hashing and Signing"><noscript><img src="/images/zh-TW/post/2018/solidity-gas-optimization-variable-ordering/solidity-logo.svg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Solidity - EIP-712 Typed Structured Data Hashing and Signing"></noscript></a><div class="content"><a class="title" href="/en/post/solidity-eip-712-typed-structured-data-hashing-and-signing/" title="Solidity - EIP-712 Typed Structured Data Hashing and Signing">Solidity - EIP-712 Typed Structured Data Hashing and Signing</a><time datetime="2023-10-12T12:39:22.000Z" title="Created 2023-10-12 20:39:22">2023-10-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/post/using-ethers-js-to-sign-and-recover/" title="Using Ethers.js to Sign and Recover"><img src="/images/loading.svg" data-src="/images/zh-TW/post/2023/ethers-js-parse-custom-error/ethers.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Using Ethers.js to Sign and Recover"><noscript><img src="/images/zh-TW/post/2023/ethers-js-parse-custom-error/ethers.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Using Ethers.js to Sign and Recover"></noscript></a><div class="content"><a class="title" href="/en/post/using-ethers-js-to-sign-and-recover/" title="Using Ethers.js to Sign and Recover">Using Ethers.js to Sign and Recover</a><time datetime="2023-10-11T11:59:57.000Z" title="Created 2023-10-11 19:59:57">2023-10-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/post/using-web3-js-to-sign-and-recover/" title="Using Web3.js to Sign and Recover"><img src="/images/loading.svg" data-src="/images/zh-TW/post/2023/using-web3-js-to-parse-custom-error/web3js.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Using Web3.js to Sign and Recover"><noscript><img src="/images/zh-TW/post/2023/using-web3-js-to-parse-custom-error/web3js.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Using Web3.js to Sign and Recover"></noscript></a><div class="content"><a class="title" href="/en/post/using-web3-js-to-sign-and-recover/" title="Using Web3.js to Sign and Recover">Using Web3.js to Sign and Recover</a><time datetime="2023-10-10T01:03:27.000Z" title="Created 2023-10-10 09:03:27">2023-10-10</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2010 - 2023 By emn178</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4"></script><script src="/js/main.js?v=14"></script><div class="js-pjax"><script>function loadDisqus(){var e,t,s=function(){this.page.url="https://blog.emn178.cc/en/post/load-css-asynchronously/",this.page.identifier="/en/post/load-css-asynchronously/",this.page.title="Load CSS Asynchronously"};window.disqusReset=()=>{DISQUS.reset({reload:!0,config:s})},window.DISQUS?disqusReset():(e=document,(t=e.createElement("script")).src="https://emn178.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)),document.getElementById("darkmode").addEventListener("click",()=>{setTimeout(()=>window.disqusReset(),200)})}{function loadOtherComment(){loadDisqus()}btf.loadComment(document.getElementById("disqus_thread"),loadDisqus)}</script></div></div></body></html>