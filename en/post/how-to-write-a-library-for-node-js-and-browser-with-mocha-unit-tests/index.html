<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="content-language" content="en"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>How to Write a Library for Node.js and Browser with Mocha Unit Tests | emn178's Blog</title><meta name="keywords" content="Programming,Node.js,JavaScript,mocha,unit test"><meta name="author" content="emn178"><meta name="copyright" content="emn178"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Mocha is a test framework for JavaScript, it provides Node.js and browser versions. Assume we implement a JavaScript library and we want to run unit t"><meta property="og:type" content="article"><meta property="og:title" content="How to Write a Library for Node.js and Browser with Mocha Unit Tests"><meta property="og:url" content="https://blog.emn178.cc/en/post/how-to-write-a-library-for-node-js-and-browser-with-mocha-unit-tests/"><meta property="og:site_name" content="emn178&#39;s Blog"><meta property="og:description" content="Mocha is a test framework for JavaScript, it provides Node.js and browser versions. Assume we implement a JavaScript library and we want to run unit t"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://blog.emn178.cc/images/en/post/2015/how-to-write-a-library-for-node-js-and-browser-with-mocha-unit-tests/20230426115551.png"><meta property="article:published_time" content="2015-10-28T09:20:00.000Z"><meta property="article:modified_time" content="2023-04-26T04:02:05.184Z"><meta property="article:author" content="emn178"><meta property="article:tag" content="Node.js"><meta property="article:tag" content="JavaScript"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://blog.emn178.cc/images/en/post/2015/how-to-write-a-library-for-node-js-and-browser-with-mocha-unit-tests/20230426115551.png"><link rel="shortcut icon" href="/favicon.png"><link rel="canonical" href="https://blog.emn178.cc/en/post/how-to-write-a-library-for-node-js-and-browser-with-mocha-unit-tests/"><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""><link rel="stylesheet" href="/css/index.css?v=18"><link rel="preload" href="/libs/fontawesome-free-6.4.0/css/all.min.css" as="style" onload="this.onload=null;this.rel=&quot;stylesheet&quot;"><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:void 0,translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"Copy successfully",error:"Copy error",noSupport:"The browser does not support"},relativeDate:{homepage:!1,post:!1},runtime:"",date_suffix:{just:"Just",min:"minutes ago",hour:"hours ago",day:"days ago",month:"months ago"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1,percent:{toc:!0,rightside:!1}},delayScripts=[],delayStyles=[],maybeMobile=window.innerWidth<=800;if(delayScripts.push({delay:maybeMobile?1e3:0,src:"/js/lazyload.iife.min.js",onload:()=>initLazyLoad()}),delayScripts.push({delay:maybeMobile?2e3:1e3,src:"/js/fancybox.umd.min.js",onload:()=>runLightbox()}),delayStyles.push({delay:maybeMobile?2e3:1e3,href:"/css/fancybox.min.css"}),delayScripts.push({delay:3e3,src:"/libs/share-js/js/social-share.min.js"}),delayStyles.push({delay:3e3,href:"/libs/share-js/css/share.min.css"}),"localhost:4000"!==location.host){function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-MPNMQM2EN1"),gtag({event:"gtm.js","gtm.start":(new Date).getTime(),"gtm.uniqueEventId":0})}function initGTMOnEvent(e){document.removeEventListener(event.type,initGTMOnEvent),initGTM()}function initGTM(){if(window.gtmDidInit)return;window.gtmDidInit=!0;const e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=/G-MPNMQM2EN1",document.head.appendChild(e)}document.addEventListener("DOMContentLoaded",()=>{setTimeout(initGTM,3500)}),document.addEventListener("scroll",initGTMOnEvent),document.addEventListener("mousemove",initGTMOnEvent),document.addEventListener("touchstart",initGTMOnEvent)</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"How to Write a Library for Node.js and Browser with Mocha Unit Tests",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2023-04-26 12:02:05"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const n=864e5*o,a={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=o,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)}),e.getCSS=(e,t=!1)=>new Promise((o,n)=>{const a=document.createElement("link");a.rel="stylesheet",a.href=e,t&&(a.id=t),a.onerror=n,a.onload=a.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,o())},document.head.appendChild(a)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="alternate" href="/en/atom.xml" title="小殘的程式光廊" type="application/atom+xml">
<link rel="alternate" href="/en/rss2.xml" title="小殘的程式光廊" type="application/rss+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/images/loading.svg" data-src="/images/avatar.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"><noscript><img src="/images/avatar.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></noscript></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">68</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">6</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/en/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/en/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/en/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-rss"></i><span> Subscriptions</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/en/atom.xml"><i class="fa-fw fas fa-rss"></i><span> ATOM</span></a></li><li><a class="site-page child" href="/en/rss2.xml"><i class="fa-fw fas fa-rss"></i><span> RSS</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/zh-TW/"><i class="fa-fw fas fa-globe"></i><span> 中文</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(/images/en/post/2015/how-to-write-a-library-for-node-js-and-browser-with-mocha-unit-tests/20230426115551.png)"><nav id="nav"><span id="blog-info"><a href="/en/" title="emn178's Blog"><span class="site-name">emn178's Blog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/en/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/en/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/en/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-rss"></i><span> Subscriptions</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/en/atom.xml"><i class="fa-fw fas fa-rss"></i><span> ATOM</span></a></li><li><a class="site-page child" href="/en/rss2.xml"><i class="fa-fw fas fa-rss"></i><span> RSS</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/zh-TW/"><i class="fa-fw fas fa-globe"></i><span> 中文</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">How to Write a Library for Node.js and Browser with Mocha Unit Tests</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fas fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2015-10-28T09:20:00.000Z" title="Created 2015-10-28 17:20:00">2015-10-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-04-26T04:02:05.184Z" title="Updated 2023-04-26 12:02:05">2023-04-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/en/categories/Programming/">Programming</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><a target="_blank" rel="noopener" href="http://mochajs.org/">Mocha</a> is a test framework for JavaScript, it provides Node.js and browser versions. Assume we implement a JavaScript library and we want to run unit tests automatically. And also, we want that it could be used in Node.js and browsers. We can use following methods to do that.</p><p>This example files structure look like this:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">src\md5.js</span><br><span class="line">tests\test.js</span><br><span class="line">tests\node-test.js</span><br><span class="line">tests\index.html</span><br><span class="line">package.json</span><br></pre></td></tr></table></figure><p>Or refer to <a target="_blank" rel="noopener" href="https://github.com/emn178/js-md5">js-md5</a>.</p><h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><p>Install mocha package to your project.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install mocha --save-dev</span><br><span class="line">npm install expect.js --save-dev</span><br></pre></td></tr></table></figure><p>If you do not initialize npm project, you can create it at first:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init</span><br></pre></td></tr></table></figure><p>The <code>package.json</code> should look like this:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">&quot;devDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;expect.js&quot;</span><span class="punctuation">:</span> <span class="string">&quot;~0.3.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;mocha&quot;</span><span class="punctuation">:</span> <span class="string">&quot;~2.3.2&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="Export"><a href="#Export" class="headerlink" title="Export"></a>Export</h2><p>We have to detect the environment is in Node.js or browser. Assume we implement a md5 fundtion:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">;(<span class="keyword">function</span>(<span class="params">root, <span class="literal">undefined</span></span>) &#123;</span><br><span class="line">  <span class="comment">// ....</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">exports</span> === <span class="string">&#x27;object&#x27;</span> &amp;&amp; <span class="keyword">typeof</span> <span class="built_in">exports</span>.<span class="property">nodeName</span> !== <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable language_">module</span>.<span class="property">exports</span> = md5;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(root) &#123;</span><br><span class="line">    root.<span class="property">md5</span> = md5;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;(<span class="variable language_">this</span>));</span><br></pre></td></tr></table></figure><h2 id="Write-Unit-Tests"><a href="#Write-Unit-Tests" class="headerlink" title="Write Unit Tests"></a>Write Unit Tests</h2><p>Create a test file, eg. <code>tests/test.js</code> and start to write our unit tests. Eg.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;less than 64 bytes&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;should be successful&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">expect</span>(<span class="title function_">md5</span>(<span class="string">&#x27;&#x27;</span>)).<span class="property">to</span>.<span class="title function_">be</span>(<span class="string">&#x27;d41d8cd98f00b204e9800998ecf8427e&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h2><h3 id="Node-js-Test-File"><a href="#Node-js-Test-File" class="headerlink" title="Node.js Test File"></a>Node.js Test File</h3><p>We create the other file for preparing to run unit test. Eg. <code>node-test.js</code> and add following code:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">md5 = <span class="built_in">require</span>(<span class="string">&#x27;../src/md5.js&#x27;</span>);</span><br><span class="line">expect = <span class="built_in">require</span>(<span class="string">&#x27;expect.js&#x27;</span>);</span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;./test.js&#x27;</span>);</span><br></pre></td></tr></table></figure><p>We export the methods which we used in unit test to global variables.</p><h3 id="Run-Test"><a href="#Run-Test" class="headerlink" title="Run Test"></a>Run Test</h3><p>We can run this command to test:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mocha node-test.js</span><br></pre></td></tr></table></figure><p>We can add this command to <code>package.json</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mocha tests/node-test.js&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>Now, we can run tests by:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm test</span><br></pre></td></tr></table></figure><p>And we can see the results like this<br><img src="/images/loading.svg" data-src="/images/en/post/2015/how-to-write-a-library-for-node-js-and-browser-with-mocha-unit-tests/20230426115551.png" alt="Node.js Unit Tests" title="Node.js Unit Tests" width="330" height="357"><noscript><img src="/images/en/post/2015/how-to-write-a-library-for-node-js-and-browser-with-mocha-unit-tests/20230426115551.png" alt="Node.js Unit Tests" title="Node.js Unit Tests" width="330" height="357"></noscript></p><h2 id="Run-in-Browsers"><a href="#Run-in-Browsers" class="headerlink" title="Run in Browsers"></a>Run in Browsers</h2><p>If you also want to run in browser, you can create a test page like this:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>MD5<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- Load libraries start --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdnjs.cloudflare.com/ajax/libs/mocha/2.1.0/mocha.min.css&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdnjs.cloudflare.com/ajax/libs/mocha/2.1.0/mocha.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdnjs.cloudflare.com/ajax/libs/expect.js/0.2.0/expect.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- Load libraries  end --&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Mocha initialization start --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;mocha&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    mocha.<span class="title function_">setup</span>(<span class="string">&#x27;bdd&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Mocha initialization end --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Load our package and test files start --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../src/md5.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;test.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Load our package and test files end --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Run tests start --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">    mocha.checkLeaks();</span><br><span class="line">    mocha.run();</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Run tests end --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>And you can open web page in browsers. You will see:<br><img src="/images/loading.svg" data-src="/images/en/post/2015/how-to-write-a-library-for-node-js-and-browser-with-mocha-unit-tests/20230426115533.png" alt="JavaScript Unit Tests" title="JavaScript Unit Tests" width="190" height="255"><noscript><img src="/images/en/post/2015/how-to-write-a-library-for-node-js-and-browser-with-mocha-unit-tests/20230426115533.png" alt="JavaScript Unit Tests" title="JavaScript Unit Tests" width="190" height="255"></noscript></p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://blog.emn178.cc">小殘</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://blog.emn178.cc/en/post/how-to-write-a-library-for-node-js-and-browser-with-mocha-unit-tests/">https://blog.emn178.cc/en/post/how-to-write-a-library-for-node-js-and-browser-with-mocha-unit-tests/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/en/tags/Node-js/">Node.js</a><a class="post-meta__tags" href="/en/tags/JavaScript/">JavaScript</a></div><div class="post_share"><div class="social-share" data-image="/images/en/post/2015/how-to-write-a-library-for-node-js-and-browser-with-mocha-unit-tests/20230426115551.png" data-initialized="true"><a class="social-share-icon icon-facebook" href="#" aria-label="share to facebook"></a><a class="social-share-icon icon-twitter" href="#" aria-label="share to twitter"></a><a class="social-share-icon icon-wechat" href="#" aria-label="share to wechat"></a><a class="social-share-icon icon-weibo" href="#" aria-label="share to weibo"></a><a class="social-share-icon icon-qq" href="#" aria-label="share to qq"></a></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/en/post/node-js-how-to-integrate-travis-ci-with-github/" title="Node.js - How to Integrate Travis CI with GitHub"><img class="cover" src="/images/loading.svg" data-src="/images/en/post/2015/node-js-how-to-integrate-travis-ci-with-github/cover.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><noscript><img class="cover" src="/images/en/post/2015/node-js-how-to-integrate-travis-ci-with-github/cover.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"></noscript><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Node.js - How to Integrate Travis CI with GitHub</div></div></a></div><div class="next-post pull-right"><a href="/en/post/how-to-measure-javascript-code-coverage-with-jscoverage/" title="How to Measure JavaScript Code Coverage With jscoverage"><img class="cover" src="/images/loading.svg" data-src="/images/en/post/2015/how-to-measure-javascript-code-coverage-with-jscoverage/20230426114841.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><noscript><img class="cover" src="/images/en/post/2015/how-to-measure-javascript-code-coverage-with-jscoverage/20230426114841.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"></noscript><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">How to Measure JavaScript Code Coverage With jscoverage</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/en/post/node-js-how-to-integrate-travis-ci-with-github/" title="Node.js - How to Integrate Travis CI with GitHub"><img class="cover" src="/images/loading.svg" data-src="/images/en/post/2015/node-js-how-to-integrate-travis-ci-with-github/cover.png" alt="cover"><noscript><img class="cover" src="/images/en/post/2015/node-js-how-to-integrate-travis-ci-with-github/cover.png" alt="cover"></noscript><div class="content is-center"><div class="date"><i class="fas fa-calendar-alt fa-fw"></i> 2015-10-28</div><div class="title">Node.js - How to Integrate Travis CI with GitHub</div></div></a></div><div><a href="/en/post/how-to-measure-javascript-code-coverage-with-jscoverage/" title="How to Measure JavaScript Code Coverage With jscoverage"><img class="cover" src="/images/loading.svg" data-src="/images/en/post/2015/how-to-measure-javascript-code-coverage-with-jscoverage/20230426114841.jpg" alt="cover"><noscript><img class="cover" src="/images/en/post/2015/how-to-measure-javascript-code-coverage-with-jscoverage/20230426114841.jpg" alt="cover"></noscript><div class="content is-center"><div class="date"><i class="fas fa-calendar-alt fa-fw"></i> 2015-10-30</div><div class="title">How to Measure JavaScript Code Coverage With jscoverage</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 評論</span></div></div><div class="comment-wrap"><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/images/loading.svg" data-src="/images/avatar.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"><noscript><img src="/images/avatar.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></noscript></div><div class="author-info__name">emn178</div><div class="author-info__description">A blog sharing experiences about programming and technology.</div></div><div class="card-info-data site-data is-center"><a href="/en/archives/"><div class="headline">Articles</div><div class="length-num">16</div></a><a href="/en/tags/"><div class="headline">Tags</div><div class="length-num">5</div></a><a href="/en/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Installation"><span class="toc-number">1.</span> <span class="toc-text">Installation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Export"><span class="toc-number">2.</span> <span class="toc-text">Export</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Write-Unit-Tests"><span class="toc-number">3.</span> <span class="toc-text">Write Unit Tests</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Test"><span class="toc-number">4.</span> <span class="toc-text">Test</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Node-js-Test-File"><span class="toc-number">4.1.</span> <span class="toc-text">Node.js Test File</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Run-Test"><span class="toc-number">4.2.</span> <span class="toc-text">Run Test</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Run-in-Browsers"><span class="toc-number">5.</span> <span class="toc-text">Run in Browsers</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/en/post/scam-token-check-tools-token-sniffer-and-goplus/" title="Token Checker - Token Sniffer and GoPlus"><img src="/images/loading.svg" data-src="/images/zh-TW/post/2023/scam-token-check-tools-token-sniffer-and-goplus/20230608214319.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Token Checker - Token Sniffer and GoPlus"><noscript><img src="/images/zh-TW/post/2023/scam-token-check-tools-token-sniffer-and-goplus/20230608214319.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Token Checker - Token Sniffer and GoPlus"></noscript></a><div class="content"><a class="title" href="/en/post/scam-token-check-tools-token-sniffer-and-goplus/" title="Token Checker - Token Sniffer and GoPlus">Token Checker - Token Sniffer and GoPlus</a><time datetime="2023-06-10T12:33:37.000Z" title="Created 2023-06-10 20:33:37">2023-06-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/post/layerzero-airdrop-guide/" title="LayerZero Airdrop Guide"><img src="/images/loading.svg" data-src="/images/zh-TW/post/2023/layerzero-airdrop-guide/LayerZero.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="LayerZero Airdrop Guide"><noscript><img src="/images/zh-TW/post/2023/layerzero-airdrop-guide/LayerZero.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="LayerZero Airdrop Guide"></noscript></a><div class="content"><a class="title" href="/en/post/layerzero-airdrop-guide/" title="LayerZero Airdrop Guide">LayerZero Airdrop Guide</a><time datetime="2023-06-09T14:32:17.000Z" title="Created 2023-06-09 22:32:17">2023-06-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/post/linea-airdrop-guide/" title="Linea Airdrop Guide"><img src="/images/loading.svg" data-src="/images/zh-TW/post/2023/linea-airdrop-guide/20230518230256.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Linea Airdrop Guide"><noscript><img src="/images/zh-TW/post/2023/linea-airdrop-guide/20230518230256.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Linea Airdrop Guide"></noscript></a><div class="content"><a class="title" href="/en/post/linea-airdrop-guide/" title="Linea Airdrop Guide">Linea Airdrop Guide</a><time datetime="2023-06-06T15:11:26.000Z" title="Created 2023-06-06 23:11:26">2023-06-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/post/awesome-crypto-world-acw-scam-token/" title="Blockchain Scam - Awesome Crypto World (ACW) Token"><img src="/images/loading.svg" data-src="/images/zh-TW/post/2023/awesome-crypto-world-acw-scam-token/20230605095502.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Blockchain Scam - Awesome Crypto World (ACW) Token"><noscript><img src="/images/zh-TW/post/2023/awesome-crypto-world-acw-scam-token/20230605095502.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Blockchain Scam - Awesome Crypto World (ACW) Token"></noscript></a><div class="content"><a class="title" href="/en/post/awesome-crypto-world-acw-scam-token/" title="Blockchain Scam - Awesome Crypto World (ACW) Token">Blockchain Scam - Awesome Crypto World (ACW) Token</a><time datetime="2023-06-05T15:00:11.000Z" title="Created 2023-06-05 23:00:11">2023-06-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/post/starknet-airdrop-guide/" title="StarkNet Airdrop Guide"><img src="/images/loading.svg" data-src="/images/zh-TW/post/2023/starknet-airdrop-strategy/22691.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="StarkNet Airdrop Guide"><noscript><img src="/images/zh-TW/post/2023/starknet-airdrop-strategy/22691.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="StarkNet Airdrop Guide"></noscript></a><div class="content"><a class="title" href="/en/post/starknet-airdrop-guide/" title="StarkNet Airdrop Guide">StarkNet Airdrop Guide</a><time datetime="2023-04-02T12:09:49.000Z" title="Created 2023-04-02 20:09:49">2023-04-02</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2010 - 2023 By emn178</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4"></script><script src="/js/main.js?v=11"></script><div class="js-pjax"><script>function loadDisqus(){var e,t,s=function(){this.page.url="https://blog.emn178.cc/en/post/how-to-write-a-library-for-node-js-and-browser-with-mocha-unit-tests/",this.page.identifier="/en/post/how-to-write-a-library-for-node-js-and-browser-with-mocha-unit-tests/",this.page.title="How to Write a Library for Node.js and Browser with Mocha Unit Tests"};window.disqusReset=()=>{DISQUS.reset({reload:!0,config:s})},window.DISQUS?disqusReset():(e=document,(t=e.createElement("script")).src="https://emn178.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)),document.getElementById("darkmode").addEventListener("click",()=>{setTimeout(()=>window.disqusReset(),200)})}{function loadOtherComment(){loadDisqus()}btf.loadComment(document.getElementById("disqus_thread"),loadDisqus)}</script></div></div></body></html>